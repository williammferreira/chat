{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% block extrastyle %}
    <link rel="stylesheet"
          href="{% static 'css/chat-update.css' %}"
          type="text/css">
{% endblock extrastyle %}
{% block content %}
    <div class="form-wrapper">
        <div class="form">
            <p class="chat-name">
                {% blocktrans with description=form.instance.chat.description %}
                    Settings for {{ description }}
                {% endblocktrans %}
            </p>
            <a class="close"
               href="{% url 'client:allchats' %}"
               id="close_image_wrapper">
                <img src="{% static 'images/close.png' %}"
                     data-src-default="{% static 'images/close.png' %}"
                     data-src-black="{% static 'images/close_black.png' %}"
                     width="30px"
                     height="30px"
                     alt="Close"
                     id="close_img">
            </a>
            <form action="" method="post">
                {% csrf_token %}
                {% for field in form %}
                    {% if field.field.widget.input_type == 'checkbox' %}
                        <label for="{{ field.name }}">{{ field.label }}:</label>
                        <div class="checkbox-wrapper">
                            {{ field }}
                            <div class="checkbox"></div>
                            <img class="checkbox-checked" src="{% static 'images/checkmark.png' %}">
                        </div>
                    {% else %}
                        <label for="{{ field.name }}">{{ field.label }}:</label>
                        {{ field }}
                    {% endif %}
                {% endfor %}
                <br>
                <input type="submit" value="Change">
            </form>
            <div class="danger-wrapper">
                {% with form.instance.chat as chat %}
                    <fieldset class="danger">
                        <legend>
                            {% trans 'Danger Zone' %}
                        </legend>
                        {% if chat.creator == request.user %}
                            <div class="danger-option">
                                <div class="info">
                                    <p class="title">{% trans 'Delete' %}</p>
                                    <p class="description">{% trans 'Your chat will be deleted. This action is irreversible.' %}</p>
                                </div>
                                <form action="{% url 'client:delete' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="location" value="{{ chat.location }}">
                                    <input type="submit" value="{% trans 'Delete' %}">
                                </form>
                            </div>
                            <hr>
                            <div class="danger-option">
                                <div class="info">
                                    <p class="title">{% trans 'Transfer Ownership' %}</p>
                                    <p class="description">
                                        {% trans 'You will transfer all administrative privileges of this chat to the selected person. This action is irreversible.' %}
                                    </p>
                                </div>
                            </div>
                        {% else %}
                            <div class="danger-option">
                                <div class="info">
                                    <p class="title">{% trans 'Leave' %}</p>
                                    <p class="description">{% trans "You will be removed from this chat. You can't rejoin unless you are reinvited." %}</p>
                                </div>
                                <form action="{% url 'client:leave' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="location" value="{{ chat.location }}">
                                    <input type="submit" value="{% trans 'Leave' %}">
                                </form>
                            </div>
                        {% endif %}
                    </fieldset>
                {% endwith %}
            </div>
        </div>
    </div>
{% endblock content %}
{% block extrascripts %}
    <script src="{% static 'js/chat-update.js' %}" type="text/javascript"></script>
{% endblock extrascripts %}
